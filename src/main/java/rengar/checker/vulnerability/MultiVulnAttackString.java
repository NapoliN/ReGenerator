package rengar.checker.vulnerability;

import rengar.checker.attack.AttackString;
import java.util.*;
import rengar.parser.charutil.CharUtil;

public class MultiVulnAttackString {
    private final List<AttackString> attackStrings;
    private int[] postfix;

    public MultiVulnAttackString() {
        this.attackStrings = new ArrayList<>();
    }

    public void AddAttackString(AttackString attackString) {
        this.attackStrings.add(attackString);
    }

    public void setPostfix(int[] postfix) {
        this.postfix = postfix;
    }

    public String genStr() {
        StringBuilder sb = new StringBuilder();
        for (AttackString attackString : attackStrings) {
            sb.append(attackString.genStr());
        }
        sb.append(CharUtil.toString(postfix));
        return sb.toString();
    }

    public String genReadableString(){
        StringBuilder sb = new StringBuilder();
        for (AttackString attackString : attackStrings) {
            sb.append(attackString.genReadableStrWithoutPostfix());
            sb.append(" + ");
        }
        sb.append(CharUtil.toPrintableString(postfix));
        return sb.toString();
    }
}
